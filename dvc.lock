schema: '2.0'
stages:
  preprocess:
    cmd: python3 -u preprocessing.py
    deps:
    - path: data/raw-area-responses/
      hash: md5
      md5: df68177328b5724e5cdb798048b81612.dir
      size: 892056328
      nfiles: 2
    - path: preprocessing.py
      hash: md5
      md5: 3f55ca4c5a9147f2533e099f2eaee84c
      size: 1332
    params:
      params.yaml:
        preprocess:
          areas:
          - VISp
          - VISl
          lag-time: 0
          lag-area: VISl
          step-size: 0.01
          bin-size: 0.1
          stimulus-duration: 0.25
    outs:
    - path: data/area-responses/
      hash: md5
      md5: a12d13834074d3699d5fdbc7471f8c37.dir
      size: 89205928
      nfiles: 2
  rrr_analysis:
    cmd: python3 -u rrr_analysis.py
    deps:
    - path: data/area-responses/
      hash: md5
      md5: 18a4a286fc913c2b7dca2a17b792fbe4.dir
      size: 27702328
      nfiles: 2
    params:
      params.yaml:
        cache:
          location: data/.vbn_s3_cache
          force_download: false
        rrr:
          cv: 5
          rank: 10
    outs:
    - path: results/rrr_coefficients.pickle
      hash: md5
      md5: 602969e22ae61fd2082ce408273d3275
      size: 360803
  plots:
    cmd: python3 -u rrr-score-time-plot.py
    deps:
    - path: results/rrr-score-time.pickle
      hash: md5
      md5: 3c0d54a947faf63dd08e66b31cd0e336
      size: 1087
    - path: rrr-score-time-plot.py
      hash: md5
      md5: 2d6df910b19eb3bd14cf6e820cd9ca4a
      size: 484
    params:
      params.yaml:
        preprocess:
          areas:
          - VISp
          - VISl
          lag-time: 0
          lag-area: VISl
          step-size: 0.01
          bin-size: 0.1
          stimulus-duration: 0.25
        rrr:
          cv: 2
          rank: 12
          error-score: raise
          predictor: VISp
          target: VISl
    outs:
    - path: figures/rrr-score-time.png
      hash: md5
      md5: 092e60d429e5f3ce1dd466d77ac4e896
      size: 36438
  time_lag_analysis:
    cmd: python3 -u time_lag_analysis.py
    deps:
    - path: data/area-responses/
      hash: md5
      md5: c0d25e573c80757dee5540640262535b.dir
      size: 577559292
      nfiles: 3
    params:
      params.yaml:
        preprocess:
          areas:
          - VISp
          - VISl
          stimulus-block: 5
          bin-size: 0.005
          stimulus-duration: 0.25
        rrr:
          cv: 5
          rank: 10
    outs:
    - path: results/VISp_VISl_cross-time-coeffs.pickle
      hash: md5
      md5: 3ab7d9da547a0cfffcdb0b7bf2eec32f
      size: 20152
  analysis:
    cmd: python3 -u rrr-score-time.py
    deps:
    - path: data/area-responses/
      hash: md5
      md5: a12d13834074d3699d5fdbc7471f8c37.dir
      size: 89205928
      nfiles: 2
    - path: rrr-score-time.py
      hash: md5
      md5: fb6ee1ccf33cf0b3ee33910b8886c3c2
      size: 1238
    params:
      params.yaml:
        preprocess:
          areas:
          - VISp
          - VISl
          lag-time: 0
          lag-area: VISl
          step-size: 0.01
          bin-size: 0.1
          stimulus-duration: 0.25
        rrr:
          cv: 2
          rank: 12
          error-score: raise
          predictor: VISp
          target: VISl
    outs:
    - path: results/rrr-score-time.pickle
      hash: md5
      md5: 3c0d54a947faf63dd08e66b31cd0e336
      size: 1087
  behav-preprocess:
    cmd: python3 -u behav-preprocessing.py
    deps:
    - path: behav-preprocessing.py
      hash: md5
      md5: 7451924b8d7170dc7280fb4455e536c4
      size: 1524
    params:
      params.yaml:
        preprocess:
          areas:
          - VISp
          - VISl
          stimulus-block: 5
          step-size: 0.025
          bin-size: 0.05
          stimulus-duration: 0.25
    outs:
    - path: data/behav-responses/
      hash: md5
      md5: 104453b33f55c1aeb16f66da4bcfefdd.dir
      size: 1151766
      nfiles: 3
  load:
    cmd: python3 -u load_raw_activity_data.py
    deps:
    - path: load_raw_activity_data.py
      hash: md5
      md5: 8422ee0dd72b27242666f38599e02bfc
      size: 860
    params:
      params.yaml:
        load:
          session: 1112515874
          areas:
          - VISp
          - VISl
          stimulus-block: 5
          step-size: 0.001
          stimulus-duration: 0.25
    outs:
    - path: data/raw-area-responses/
      hash: md5
      md5: df68177328b5724e5cdb798048b81612.dir
      size: 892056328
      nfiles: 2
  dimensionality-reduction:
    cmd: python3 -u cv-lag-time-selection.py
    deps:
    - path: cv-lag-time-selection.py
      hash: md5
      md5: 965a07f1bed342b2c2fad2c2dde90119
      size: 886
    - path: results/CV-lag-time.pickle
      hash: md5
      md5: d0f0c894fa996641bec510dcc4f0ccdd
      size: 442
    outs:
    - path: results/CV-lag-time_max-mean.pickle
      hash: md5
      md5: 075529a1c01fe2f4196054b96158e56d
      size: 221
    - path: results/CV-lag-time_max-mean_name.pickle
      hash: md5
      md5: 1416be89675e4e1240eeb07b8c5cafbb
      size: 18
